{
  "id": "bpmn-type-bpmn:UserTask",
  "formKey": "",
  "title": {
    "en": "BPMN User Task Form"
  },
  "description": {},
  "customModule": "",
  "typeRef": "",
  "width": "lg",
  "system": true,
  "i18n": {
    "ru": {
      "task_priority_low": "Низкий",
      "task_priority_medium": "Средний",
      "task_priority_high": "Высокий"
    },
    "en": {
      "task_priority_low": "Low",
      "task_priority_medium": "Medium",
      "task_priority_high": "High"
    }
  },
  "definition": {
    "components": [
      {
        "label": "load roles",
        "source": {
          "type": "recordsScript",
          "recordsScript": {
            "attributes": {
              "rolesData": "model.roles[]{value:id,label:name}"
            },
            "script": "let ref = instance.options.editor.getEcosType();\n\nif (!!ref) {\n  value = ref;\n}"
          },
          "forceLoad": false
        },
        "update": {
          "type": "once",
          "rate": 300
        },
        "key": "roles",
        "type": "asyncData",
        "input": true
      },
      {
        "formRef": "uiserv/form@bpmn-base-form-elements",
        "input": true,
        "key": "includeForm2",
        "label": "Форма: Bpmn base form elements",
        "type": "includeForm"
      },
      {
        "label": {
          "ru": "Panel"
        },
        "key": "panel-recipients",
        "title": {
          "ru": "Назначение пользователей",
          "en": "User assignment"
        },
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "type": "panel",
        "input": false,
        "components": [
          {
            "label": {
              "ru": "Ручное назначение",
              "en": "Manual assignment"
            },
            "key": "manualRecipientsMode",
            "refreshOn": [],
            "optionalWhenDisabled": false,
            "type": "checkbox",
            "input": true
          },
          {
            "label": {
              "en": "Assignees",
              "ru": "Реципиенты"
            },
            "key": "assignees",
            "tooltip": {
              "ru": "Выбор реципиентов задачи из ролей типа ecos",
              "en": "Selecting task assignees from roles of the ecos type"
            },
            "multiple": true,
            "validate": {
              "required": true
            },
            "reorder": false,
            "dataSrc": "custom",
            "data": {
              "custom": "values = _.get(data, 'roles.rolesData');"
            },
            "defaultValue": "",
            "refreshOn": [
              "roles"
            ],
            "optionalWhenDisabled": false,
            "customConditional": "show = !!!data.manualRecipientsMode;",
            "type": "ecosSelect",
            "input": true
          },
          {
            "label": {
              "en": "Assignees",
              "ru": "Реципиенты"
            },
            "key": "manualRecipients",
            "tooltip": {
              "ru": "Имя или recordRef реципиента. \n\nПоддерживаются expression для получения реципиентов из переменных или сервисов. Expression может вернуть множественное значение - строки разделенные запятой: user1,user2,user3\n\nНапример:\nivan.petrov\nGROUP_company_accountant\nemodel/authority-group@company_accountant\n${someVariable}\n${someService.getRecipients()},petya.voks",
              "en": "Name or recordRef of recipient. \n\nExpressions are supported to get recipients from variables or services. Expression can return multiple value - comma separated strings: user1,user2,user3\n\nExample:\nivan.petrov\nGROUP_company_accountant\nemodel/authority-group@company_accountant\n${someVariable}\n${someService.getRecipients()},petya.voks"
            },
            "multiple": true,
            "validate": {
              "required": true
            },
            "reorder": false,
            "refreshOn": [],
            "optionalWhenDisabled": false,
            "customConditional": "show = !!data.manualRecipientsMode;",
            "type": "textfield",
            "input": true
          }
        ]
      },
      {
        "input": true,
        "key": "horizontalLine2",
        "type": "horizontalLine"
      },
      {
        "label": {
          "ru": "Форма задачи",
          "en": "Task form"
        },
        "key": "formRef",
        "validate": {
          "required": true
        },
        "modalTitle": "",
        "journalId": "ecos-forms",
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "type": "selectJournal",
        "input": true,
        "queryData": ""
      },
      {
        "label": {
          "ru": "Follow up date",
          "en": "Follow up date"
        },
        "key": "followUpDate",
        "tooltip": {
          "en": "Date in ISO format or expression:\n\n- 2020-06-20T10:30:00\n-${someDate}\n\nThe expression should always resolve to a java.util.Date, java.util.String (ISO 8601), or null.",
          "ru": "Дата в формате ISO или выражение:\n\n- 2020-06-20T10:30:00\n- ${someDate}\n\nВыражение всегда должно  возвращать java.util.Date, java.util.String (ISO 8601) или null."
        },
        "hidden": true,
        "defaultValue": "",
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "type": "textfield",
        "input": true,
        "inputMasks": [
          {}
        ]
      },
      {
        "label": {
          "ru": "Срок выполнения",
          "en": "Due date"
        },
        "key": "dueDate",
        "tooltip": {
          "ru": "Дата в формате ISO или выражение:\n\n- 2020-06-20T10:30:00\n- ${someDate}\n\nВыражение всегда должно  возвращать java.util.Date, java.util.String (ISO 8601) или null.",
          "en": "Date in ISO format or expression:\n\n- 2020-06-20T10:30:00\n-${someDate}\n\nThe expression should always resolve to a java.util.Date, java.util.String (ISO 8601), or null."
        },
        "defaultValue": "",
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "type": "textfield",
        "input": true,
        "inputMasks": [
          {}
        ]
      },
      {
        "label": {
          "en": "Priority",
          "ru": "Приоритет"
        },
        "key": "priority",
        "validate": {
          "required": true
        },
        "dataSrc": "values",
        "data": {
          "values": [
            {
              "label": "task_priority_low",
              "value": "LOW"
            },
            {
              "label": "task_priority_medium",
              "value": "MEDIUM"
            },
            {
              "label": "task_priority_high",
              "value": "HIGH"
            }
          ]
        },
        "defaultValue": "",
        "customDefaultValue": "value = \"MEDIUM\";",
        "optionalWhenDisabled": false,
        "type": "ecosSelect",
        "input": true
      },
      {
        "label": {
          "en": "Task outcomes",
          "ru": "Результаты задачи"
        },
        "key": "outcomes",
        "multiple": true,
        "validate": {
          "required": true,
          "minLength": "",
          "maxLength": ""
        },
        "disableAddingRemovingRows": false,
        "addAnotherPosition": "bottom",
        "removePlacement": "col",
        "defaultOpen": false,
        "layoutFixed": false,
        "enableRowGroups": false,
        "reorder": true,
        "defaultValue": [
          {
            "textField": "",
            "id": "",
            "name": {
              "ru": "",
              "en": ""
            },
            "objectObject": {
              "ru": "",
              "en": ""
            },
            "_name": {
              "ru": "",
              "en": ""
            }
          }
        ],
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "type": "datagrid",
        "input": true,
        "components": [
          {
            "label": {
              "ru": "Идентификатор",
              "en": "Id"
            },
            "key": "id",
            "defaultValue": "",
            "refreshOn": [],
            "optionalWhenDisabled": false,
            "type": "textfield",
            "input": true,
            "row": "0-0"
          },
          {
            "label": {
              "en": "Name",
              "ru": "Название"
            },
            "key": "name",
            "refreshOn": [],
            "optionalWhenDisabled": false,
            "type": "mlText",
            "input": true,
            "row": "0-1"
          }
        ]
      },
      {
        "label": {
          "ru": "Panel"
        },
        "key": "panel-advanced-mi",
        "refreshOn": [],
        "optionalWhenDisabled": false,
        "customConditional": "show = !!data.manualRecipientsMode;",
        "type": "panel",
        "input": false,
        "components": [
          {
            "formRef": "uiserv/form@bpmn-base-form-multi-instance",
            "input": true,
            "key": "includeForm3",
            "label": "Форма: BPMN base form Multi Instance",
            "type": "includeForm"
          }
        ]
      }
    ],
    "formId": "bpmn-type-bpmn:UserTask"
  },
  "attributes": {}
}
